<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Gestión de Empleados</title>
        
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        
        <!-- Custom CSS -->
        <style>
            body {
                background-color: #f8f9fa;
                font-family: Arial, sans-serif;
            }
            .container {
                margin-top: 20px;
            }
            h1, h2 {
                color: #343a40;
            }
            form {
                background-color: #ffffff;
                padding: 20px;
                border-radius: 5px;
                box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
                margin-bottom: 20px;
            }
            label {
                font-weight: bold;
            }
            .btn-primary {
                background-color: #007bff;
                border: none;
            }
            table {
                background-color: #ffffff;
                box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            }
            th {
                background-color: #007bff;
                color: white;
            }
            .navbar {
                margin-bottom: 20px;
            }
        </style>
    </head>
    <body>
    
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="/">Hospital Management</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a class="nav-link" href="/habitaciones">Habitaciones</a></li>
                        <li class="nav-item"><a class="nav-link" href="/servicios">Servicios</a></li>
                        <li class="nav-item"><a class="nav-link" href="/quienes-somos">Quienes somos</a></li>
                        <li class="nav-item"><a class="nav-link" href="/empleado">Empleado</a></li>
                    </ul>
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a class="nav-link" href="/register">Register</a></li>
                        <li class="nav-item"><a class="nav-link" href="/signin">Login</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    
        <div class="container">
            <h1 class="text-center">Gestión de Empleados</h1>
    
            <!-- Formulario para guardar un empleado -->
            <h2>Guardar Empleado</h2>
            <form id="guardarEmpleadoForm">
                <div class="mb-3">
                    <label for="codigo">Código:</label>
                    <input type="text" class="form-control" id="codigo" name="codigo">
                </div>
                <div class="mb-3">
                    <label for="nombre">Nombre:</label>
                    <input type="text" class="form-control" id="nombre" name="nombre">
                </div>
                <div class="mb-3">
                    <label for="apellido">Apellido:</label>
                    <input type="text" class="form-control" id="apellido" name="apellido">
                </div>
                <div class="mb-3">
                    <label for="cargo">Cargo:</label>
                    <input type="text" class="form-control" id="cargo" name="cargo">
                </div>
                <div class="mb-3">
                    <label for="telefono">Teléfono:</label>
                    <input type="text" class="form-control" id="telefono" name="telefono">
                </div>
                <div class="mb-3">
                    <label for="correo">Correo:</label>
                    <input type="email" class="form-control" id="correo" name="correo">
                </div>
                <button type="button" class="btn btn-primary" onclick="guardarEmpleado()">Guardar Empleado</button>
            </form>
    
            <!-- Formulario para buscar un empleado por código -->
            <h2>Buscar Empleado</h2>
            <form id="buscarEmpleadoForm">
                <div class="mb-3">
                    <label for="codigoBuscar">Código:</label>
                    <input type="text" class="form-control" id="codigoBuscar" name="codigo">
                </div>
                <button type="button" class="btn btn-primary" onclick="buscarEmpleado()">Buscar Empleado</button>
            </form>
    
            <!-- Formulario para actualizar un empleado -->
            <h2>Actualizar Empleado</h2>
            <form id="actualizarEmpleadoForm">
                <div class="mb-3">
                    <label for="idActualizar">ID:</label>
                    <input type="text" class="form-control" id="idActualizar" name="id">
                </div>
                <div class="mb-3">
                    <label for="codigoActualizar">Código:</label>
                    <input type="text" class="form-control" id="codigoActualizar" name="codigo">
                </div>
                <div class="mb-3">
                    <label for="nombreActualizar">Nombre:</label>
                    <input type="text" class="form-control" id="nombreActualizar" name="nombre">
                </div>
                <div class="mb-3">
                    <label for="apellidoActualizar">Apellido:</label>
                    <input type="text" class="form-control" id="apellidoActualizar" name="apellido">
                </div>
                <div class="mb-3">
                    <label for="cargoActualizar">Cargo:</label>
                    <input type="text" class="form-control" id="cargoActualizar" name="cargo">
                </div>
                <div class="mb-3">
                    <label for="telefonoActualizar">Teléfono:</label>
                    <input type="text" class="form-control" id="telefonoActualizar" name="telefono">
                </div>
                <div class="mb-3">
                    <label for="correoActualizar">Correo:</label>
                    <input type="email" class="form-control" id="correoActualizar" name="correo">
                </div>
                <button type="button" class="btn btn-primary" onclick="actualizarEmpleado()">Actualizar Empleado</button>
            </form>
    
            <!-- Formulario para eliminar un empleado -->
            <h2>Eliminar Empleado</h2>
            <form id="eliminarEmpleadoForm">
                <div class="mb-3">
                    <label for="idEliminar">ID del Empleado:</label>
                    <input type="text" class="form-control" id="idEliminar">
                </div>
                <button type="button" class="btn btn-danger" onclick="eliminarEmpleado()">Eliminar Empleado</button>
            </form>
    
            <!-- Tabla para mostrar los empleados -->
            <h2>Lista de Empleados</h2>
            <button type="button" class="btn btn-primary mb-3" onclick="listarEmpleados()">Ver Empleados</button>
            <table id="empleadosTabla" class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Código</th>
                        <th>Nombre</th>
                        <th>Apellido</th>
                        <th>Cargo</th>
                        <th>Teléfono</th>
                        <th>Correo</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Aquí se llenarán las filas con los datos de los empleados -->
                </tbody>
            </table>
        </div>
    
        <!-- Bootstrap Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    

    <script>
        function guardarEmpleado() {
            const empleado = {
                codigo: document.getElementById("codigo").value,
                nombre: document.getElementById("nombre").value,
                apellido: document.getElementById("apellido").value,
                cargo: document.getElementById("cargo").value,
                telefono: document.getElementById("telefono").value,
                correo: document.getElementById("correo").value,
            };

            fetch("/api/empleados/guardar", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(empleado),
            })
            .then(response => response.ok ? alert("Empleado guardado con éxito") : alert("Error al guardar el empleado"));
        }

        function buscarEmpleado() {
            const codigo = document.getElementById("codigoBuscar").value;

            fetch(`/api/empleados/buscar/${codigo}`, {
                method: "GET",
                headers: { "Content-Type": "application/json" }
            })
            .then(response => response.json())
            .then(data => {
                alert(`Empleado encontrado: ${data.nombre} ${data.apellido}`);
            })
            .catch(() => alert("Empleado no encontrado"));
        }

        function actualizarEmpleado() {
            const empleado = {
                id: document.getElementById("idActualizar").value,
                codigo: document.getElementById("codigoActualizar").value,
                nombre: document.getElementById("nombreActualizar").value,
                apellido: document.getElementById("apellidoActualizar").value,
                cargo: document.getElementById("cargoActualizar").value,
                telefono: document.getElementById("telefonoActualizar").value,
                correo: document.getElementById("correoActualizar").value,
            };

            fetch("/api/empleados/actualizar", {
                method: "PUT",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(empleado),
            })
            .then(response => response.ok ? alert("Empleado actualizado con éxito") : alert("Error al actualizar el empleado"));
        }

        function eliminarEmpleado() {
            const id = document.getElementById("idEliminar").value;

            fetch(`/api/empleados/eliminar/${id}`, {
                method: "DELETE",
                headers: { "Content-Type": "application/json" }
            })
            .then(response => response.ok ? alert("Empleado eliminado con éxito") : alert("Error al eliminar el empleado"));
        }

        function listarEmpleados() {
            fetch("/api/empleados/todos", {
                method: "GET",
                headers: { "Content-Type": "application/json" }
            })
            .then(response => response.json())
            .then(data => {
                const tabla = document.getElementById("empleadosTabla").getElementsByTagName("tbody")[0];
                tabla.innerHTML = ""; // Limpiar la tabla antes de llenarla

                data.forEach(empleado => {
                    const fila = tabla.insertRow();
                    fila.insertCell(0).textContent = empleado.id;
                    fila.insertCell(1).textContent = empleado.codigo;
                    fila.insertCell(2).textContent = empleado.nombre;
                    fila.insertCell(3).textContent = empleado.apellido;
                    fila.insertCell(4).textContent = empleado.cargo;
                    fila.insertCell(5).textContent = empleado.telefono;
                    fila.insertCell(6).textContent = empleado.correo;
                });
            })
            .catch(() => alert("Error al obtener la lista de empleados"));
        }
    </script>
</body>
</html>
